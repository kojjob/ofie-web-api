#!/usr/bin/env ruby
require 'fileutils'

puts "Rails Credentials Setup Helper"
puts "=" * 50

if !File.exist?('config/master.key')
  puts "\n⚠️  No master.key found. Creating a new one..."
  system("EDITOR='echo' rails credentials:edit")
  puts "✅ Master key created at config/master.key"
  puts "\n🔑 IMPORTANT: Save the master key somewhere secure!"
  puts "Master Key: #{File.read('config/master.key').strip}"
else
  puts "✅ Master key already exists"
end

puts "\nTo edit credentials, run:"
puts "  EDITOR='code --wait' rails credentials:edit"
puts "\nRequired credentials structure:"

template = <<~YAML
  # OAuth
  google:
    client_id: your_google_client_id
    client_secret: your_google_client_secret
  
  facebook:
    app_id: your_facebook_app_id
    app_secret: your_facebook_app_secret
  
  # Stripe
  stripe:
    publishable_key: pk_live_your_key
    secret_key: sk_live_your_key
    webhook_secret: whsec_your_secret
  
  # Email
  smtp:
    user_name: your_email@gmail.com
    password: your_app_password
  
  # AWS (for Active Storage)
  aws:
    access_key_id: your_key_id
    secret_access_key: your_secret_key
    region: us-east-1
    bucket: your-bucket-name
  
  # Sentry
  sentry:
    dsn: https://your-dsn@sentry.io/project-id
  
  # Secret Key Base
  secret_key_base: generate_with_rails_secret
YAML

puts template
puts "\n" + "=" * 50
puts "Remember to add these credentials before deploying!"